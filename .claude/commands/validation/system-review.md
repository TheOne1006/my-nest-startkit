---
description: 根据计划分析实施情况，以进行流程改进
---

# 系统审查 (System Review)

对实施如何遵循计划进行元级分析，并确定流程改进。

## 目的

**系统审查不是代码审查。** 你不是在寻找代码中的错误 - 你是在寻找流程中的错误。

**你的工作：**

- 分析计划遵守和偏差模式
- 识别哪些偏差是合理的，哪些是有问题的
- 提出防止未来发生问题的流程改进
- 建议更新第 1 层资产 (`CLAUDE.md`, 计划模板, 命令)

**哲学：**

- 好的偏差揭示了计划的局限性 → 改进规划
- 坏的偏差揭示了不清楚的要求 → 改进沟通
- 重复出现的问题揭示了缺少自动化 → 创建命令

## 上下文和输入

你将分析四个关键工件：

**计划命令 (Plan Command):**
阅读此内容以了解规划过程以及指导计划创建的说明。
`.claude/commands/core_piv_loop/plan-feature.md`

**生成的计划 (Generated Plan):**
阅读此内容以了解代理**应该**做什么。
计划文件: $1

**执行命令 (Execute Command):**
阅读此内容以了解执行过程以及指导实施的说明。
`.claude/commands/core_piv_loop/execute.md`

**执行报告 (Execution Report):**
阅读此内容以了解代理**实际**做了什么以及原因。
执行报告: $2

## 分析工作流

### 第 1 步：了解计划的方法

阅读生成的计划 ($1) 并提取：

- 计划了哪些功能？
- 指定了什么架构？
- 定义了哪些验证步骤？
- 引用了哪些模式？

### 第 2 步：了解实际实施

阅读执行报告 ($2) 并提取：

- 实施了什么？
- 什么偏离了计划？
- 遇到了什么挑战？
- 跳过了什么，为什么？

### 第 3 步：分类每个偏差

对于执行报告中确定的每个偏差，分类为：

**好的偏差 ✅** (合理的):

- 计划假设了代码库中不存在的东西
- 在实施过程中发现了更好的模式
- 需要性能优化
- 发现了需要不同方法的安全问题

**坏的偏差 ❌** (有问题的):

- 忽略了计划中的明确约束
- 创建了新架构而不是遵循现有模式
- 走了捷径，引入了技术债务
- 误解了要求

### 第 4 步：追踪根本原因

对于每个有问题的偏差，确定根本原因：

- 计划不清楚吗，在哪里，为什么？
- 缺少上下文吗，在哪里，为什么？
- 缺少验证吗，在哪里，为什么？
- 手动步骤重复了吗，在哪里，为什么？

### 第 5 步：生成流程改进

基于跨偏差的模式，建议：

- **CLAUDE.md 更新:** 要记录的通用模式或反模式
- **计划命令更新:** 需要澄清的说明或缺失的步骤
- **新命令:** 应该自动化的手动流程
- **验证添加:** 可以更早发现问题的检查
